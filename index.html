<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minecraft Server</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Segoe UI', sans-serif;
            background-image: url('https://i.postimg.cc/W1V6yC1g/windows-7-wallpaper.jpg');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            overflow: hidden; /* Prevent scrolling the whole page */
        }
        .win7-window {
            box-shadow: 0 5px 25px rgba(0,0,0,0.2);
            border: 1px solid #707070;
            border-radius: 6px;
        }
        .win7-title-bar {
            background: linear-gradient(to bottom, rgba(240, 240, 240, 0.9), rgba(200, 200, 200, 0.8));
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            border-bottom: 1px solid #a0a0a0;
            padding: 5px 8px;
            border-top-left-radius: 5px;
            border-top-right-radius: 5px;
        }
        .win7-content {
            background-color: #F0F0F0;
            border-bottom-left-radius: 5px;
            border-bottom-right-radius: 5px;
        }
        .win7-controls button {
            width: 20px; height: 20px; border: 1px solid #a0a0a0;
            font-weight: bold; font-family: 'Courier New', Courier, monospace;
            line-height: 18px;
        }
        .win7-controls .close:hover { background-color: #e81123; color: white; }
        .win7-button {
            background: linear-gradient(to bottom, #f0f0f0, #e0e0e0);
            border: 1px solid #a0a0a0;
            border-radius: 3px;
            box-shadow: 0 1px 1px rgba(0,0,0,0.1);
        }
        .win7-button:hover {
            border-color: #3b82f6;
            background: linear-gradient(to bottom, #eaf5ff, #c4e0ff);
        }
        .win7-taskbar {
            background: linear-gradient(to bottom, rgba(0,0,0,0.7), rgba(0,0,0,0.8));
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            border-top: 1px solid rgba(255,255,255,0.3);
        }
        #start-menu {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            border: 1px solid #a0a0a0;
        }
        .spinner { border-top-color: #3b82f6; animation: spin 1s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }
    </style>
</head>
<body class="h-screen flex flex-col">

    <!-- Desktop Area -->
    <main class="flex-grow p-4 md:p-8 flex items-center justify-center">
        <div class="win7-window w-full max-w-5xl">
            <!-- Title Bar -->
            <div class="win7-title-bar flex justify-between items-center">
                <span class="font-bold text-sm text-black">Welcome to the Server</span>
                <div class="win7-controls flex space-x-1">
                    <button class="bg-gray-200 hover:bg-gray-300 text-black text-xs">_</button>
                    <button class="bg-gray-200 hover:bg-gray-300 text-black text-xs">[]</button>
                    <button class="bg-gray-200 close text-black">X</button>
                </div>
            </div>
            <!-- Window Content -->
            <div class="win7-content p-6 text-black">
                 <p class="mb-4">Hey everyone! Welcome to the homepage for our new modded server. This pack is all about building awesome factories with <strong>Create</strong>, becoming master chefs with <strong>Farmer's Delight</strong>, and finally having enough inventory space thanks to the <strong>Sophisticated</strong> mods.</p>
                 <p class="mb-6">I've also added <strong>Expanded Ecosphere</strong> to make the world look amazing, and the <strong>Dungeons and Taverns</strong> mods so we have some cool places to explore together. It should be a pretty stable and fun world to hang out in. Can't wait to see what you all build!</p>
                
                 <hr class="border-gray-300 my-6">

                 <h2 class="text-xl font-bold mb-4">Need an Idea?</h2>
                 <div class="grid md:grid-cols-2 gap-6">
                    <div>
                        <h3 class="font-bold mb-2">Let's Make Up Some Lore</h3>
                        <p class="text-sm mb-3">Click the button to get a silly, random backstory for our world.</p>
                        <button id="generate-backstory-btn" class="win7-button px-4 py-1.5">Tell Me a Story</button>
                        <div id="backstory-loading" class="hidden mt-2"><div class="spinner w-6 h-6 rounded-full border-4 border-gray-300"></div></div>
                        <div id="backstory-response" class="bg-white mt-2 p-2 border border-gray-300 rounded text-sm hidden"></div>
                    </div>
                     <div>
                        <h3 class="font-bold mb-2">What Should I Do Now?</h3>
                        <p class="text-sm mb-3">Not sure what to do next? Tell me what you've been up to.</p>
                        <textarea id="advisor-input" class="w-full bg-white border border-gray-400 rounded p-1 text-sm focus:ring-1 focus:ring-blue-500 focus:border-blue-500 outline-none" rows="2" placeholder="e.g., I just finished my hobbit hole..."></textarea>
                        <button id="get-advice-btn" class="win7-button px-4 py-1.5 mt-2">Give Me a Quest</button>
                        <div id="advisor-loading" class="hidden mt-2"><div class="spinner w-6 h-6 rounded-full border-4 border-gray-300"></div></div>
                        <div id="advisor-response" class="bg-white mt-2 p-2 border border-gray-300 rounded text-sm hidden"></div>
                    </div>
                 </div>
            </div>
        </div>
    </main>

    <!-- Taskbar -->
    <footer class="win7-taskbar w-full h-10 flex items-center px-2 relative">
        <!-- Start Button -->
        <button id="start-btn" class="w-10 h-10 bg-center bg-no-repeat bg-cover rounded-full" style="background-image: url('https://i.postimg.cc/1XyJc72S/win7-start-orb.png');"></button>
        
        <!-- Start Menu -->
        <div id="start-menu" class="absolute bottom-12 left-2 w-64 rounded-lg shadow-lg hidden">
            <a href="index.html" class="block px-4 py-2 text-black hover:bg-blue-300 rounded-t-lg">Home</a>
            <a href="mods.html" class="block px-4 py-2 text-black hover:bg-blue-300 rounded-b-lg">Mod List</a>
        </div>
    </footer>

    <script type="module">
        // Start Menu Logic
        const startBtn = document.getElementById('start-btn');
        const startMenu = document.getElementById('start-menu');
        startBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            startMenu.classList.toggle('hidden');
        });
        document.addEventListener('click', () => {
            startMenu.classList.add('hidden');
        });

        // Gemini API Logic (unchanged)
        const generateBackstoryBtn = document.getElementById('generate-backstory-btn');
        const backstoryResponseEl = document.getElementById('backstory-response');
        const backstoryLoadingEl = document.getElementById('backstory-loading');
        const getAdviceBtn = document.getElementById('get-advice-btn');
        const advisorInput = document.getElementById('advisor-input');
        const advisorResponseEl = document.getElementById('advisor-response');
        const advisorLoadingEl = document.getElementById('advisor-loading');
        const apiKey = "";
        const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;
        
        async function callGemini(payload, responseElement, loadingElement, buttonElement) {
            loadingElement.classList.remove('hidden');
            responseElement.classList.add('hidden');
            buttonElement.disabled = true;
            let retries = 3;
            let delay = 1000;
            while (retries > 0) {
                try {
                    const response = await fetch(apiUrl, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) });
                    if (!response.ok) { throw new Error(`HTTP error! status: ${response.status}`); }
                    const result = await response.json();
                    const candidate = result.candidates?.[0];
                    if (candidate && candidate.content?.parts?.[0]?.text) {
                        responseElement.textContent = candidate.content.parts[0].text;
                        responseElement.classList.remove('hidden');
                    } else {
                        responseElement.textContent = 'Whoops, the AI is sleeping. Try again in a bit.';
                        responseElement.classList.remove('hidden');
                    }
                    return;
                } catch (error) {
                    console.error('API Call failed:', error);
                    retries--;
                    if (retries === 0) { responseElement.textContent = 'Error: The request failed. Tell the server owner the AI is broken!'; responseElement.classList.remove('hidden'); }
                    await new Promise(res => setTimeout(res, delay));
                    delay *= 2;
                } finally {
                    loadingElement.classList.add('hidden');
                    buttonElement.disabled = false;
                }
            }
        }
        generateBackstoryBtn.addEventListener('click', async () => {
            const systemPrompt = "You are a fun and creative friend on a Minecraft server. Your task is to write a short, fun, and slightly silly backstory for our shared Minecraft world. The story should be 2-3 paragraphs long and set up a fun adventure for a group of friends. It should hint at the kinds of things we can do with our mods without naming them: themes of building crazy contraptions (Create), cooking up big feasts (Farmer's Delight), exploring cool new places (Ecosphere, Dungeons), and having awesome gear (Sophisticated). Keep the tone light and exciting!";
            const userQuery = `Tell us a fun backstory for our new Minecraft server!`;
            const payload = { contents: [{ parts: [{ text: userQuery }] }], systemInstruction: { parts: [{ text: systemPrompt }] }, };
            callGemini(payload, backstoryResponseEl, backstoryLoadingEl, generateBackstoryBtn);
        });
        getAdviceBtn.addEventListener('click', async () => {
            const userInput = advisorInput.value.trim();
            if (!userInput) { advisorResponseEl.textContent = "You gotta tell me what you've done first!"; advisorResponseEl.classList.remove('hidden'); return; }
            const systemPrompt = `You are a helpful and enthusiastic friend on a modded Minecraft server. You know all about the mods we're using. Your job is to give 3 fun and creative ideas for what someone should do next, based on what they've told you. Talk directly to the person like a friend (use "You could..." or "What if you..."). Encourage them to use the mods and maybe even suggest projects they could do with other people on the server. Your tone should be encouraging and fun, not bossy.`;
            const userQuery = `I'm playing on our server. So far, I've done this: "${userInput}". What are some fun ideas for what I should do next?`;
            const payload = { contents: [{ parts: [{ text: userQuery }] }], systemInstruction: { parts: [{ text: systemPrompt }] }, };
            callGemini(payload, advisorResponseEl, advisorLoadingEl, getAdviceBtn);
        });
    </script>
</body>
</html>

